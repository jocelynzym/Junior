## lab4 分支预测

[PB16111543 张抑淼]

### 一.实验设计

- **阶段一**: 实现btb

  -使用直接映射策略，每个PC地址对应一个固定块

  -在取指阶段利用PC寻址btb，如果命中，则说明这是一条跳转指令，利用从BTB中获取到的地址去取icache

  -在EX阶段判断预测是否正确，并相应地修改状态机状态

- **阶段二**: 实现bht

  -对于BHT在BTB的基础上实现一个状态转移图，实现2bits的转移

### 二.实验环境和工具

- vivado自带的波形仿真工具
- notapad++ 

### 三.实验内容

#### 1.真值表

| BTB  | BHT  | REAL | NPC_PRED | flush | NPC_REAL | BTB update |
| ---- | ---- | ---- | -------- | ----- | -------- | ---------- |
| Y    | Y    | Y    | BUF      | N     |          | N          |
| Y    | Y    | N    |          | Y     | PC_EX+4  |            |
| Y    | N    | Y    | PC_IF+4  |       |          |            |
| Y    | N    | N    |          |       |          |            |
| N    | Y    | Y    |          |       |          |            |
| N    | Y    | N    |          |       |          |            |
| N    | N    | Y    |          |       |          |            |
| N    | N    | N    |          |       |          |            |

2.





### 四.实验报告

分支收益和分支代价



统计未使用分支预测和使用分支预测的总周期数及差值



统计分支指令数目、动态分支预测正确次数和错误次数



对比不同策略，分析以上几点关系



计算整体CPI和加速比









